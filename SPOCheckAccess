# Install required modules
Install-Module Microsoft.Graph.Authentication
Install-Module Microsoft.Graph.Sites
Install-Module Microsoft.Graph.Files

# Connect using app-only authentication
$clientId = "your-app-client-id"
$tenantId = "your-tenant-id"
$clientSecret = "your-client-secret"

$tokenBody = @{
    Grant_Type    = "client_credentials"
    Scope         = "https://graph.microsoft.com/.default"
    Client_Id     = $clientId
    Client_Secret = $clientSecret
}

$tokenResponse = Invoke-RestMethod -Uri "https://login.microsoftonline.com/$tenantId/oauth2/v2.0/token" -Method POST -Body $tokenBody
$accessToken = $tokenResponse.access_token

Connect-MgGraph -AccessToken $accessToken

# Get site information
$siteInfo = Get-MgSite -SiteId "yourtenant.sharepoint.com:/sites/yoursitename"
$siteInfo | Format-List

# Get document libraries
$drives = Get-MgSiteDrive -SiteId $siteInfo.Id
$drives | Format-Table Name, Id

# List items in a document library
$driveId = $drives[0].Id
$items = Get-MgDriveRootChild -DriveId $driveId
$items | Format-Table Name, Size, WebUrl
